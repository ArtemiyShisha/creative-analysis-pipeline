# üéØ Creative Analysis Pipeline

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º eye-tracking (saliency prediction) –∏ AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

## üìä –ß—Ç–æ –¥–µ–ª–∞–µ—Ç

Pipeline –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∫–ª–∞–º–Ω—ã–π –±–∞–Ω–Ω–µ—Ä –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
1. **–¢–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É –≤–Ω–∏–º–∞–Ω–∏—è** (–≥–¥–µ –ª—é–¥–∏ —Å–º–æ—Ç—Ä—è—Ç)
2. **–î–µ—Ç–µ–∫—Ü–∏—é –∫–ª—é—á–µ–≤—ã—Ö –∑–æ–Ω** (logo, header, CTA, product –∏ —Ç.–¥.)
3. **Attention % –¥–ª—è –∫–∞–∂–¥–æ–π –∑–æ–Ω—ã** (—Å–∫–æ–ª—å–∫–æ –≤–Ω–∏–º–∞–Ω–∏—è –ø–æ–ª—É—á–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç)
4. **Overall Score (1-5)** - –æ–±—â—É—é –æ—Ü–µ–Ω–∫—É —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
5. **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∫—Ä–µ–∞—Ç–∏–≤–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Pipeline

```
Image
  ‚Üì
[1] DeepGaze IIE ‚Üí Saliency Map (—Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –≤–Ω–∏–º–∞–Ω–∏—è)
  ‚Üì
[2] EasyOCR ‚Üí Text blocks (–¥–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏)
  ‚Üì
[3] Python Heuristics ‚Üí Group & classify text zones
  ‚Üì
[4] GPT-4.1 Vision ‚Üí Detect visual elements (logo, product)
  ‚Üì
[5] OpenCV ‚Üí Refine CTA bbox (–Ω–∞—Ö–æ–¥–∏—Ç –∫–Ω–æ–ø–∫—É, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç)
  ‚Üì
[6] Python ‚Üí Merge zones (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç nested relationships)
  ‚Üì
[7] NumPy ‚Üí Calculate attention % (–≤—ã—á–∏—Ç–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã)
  ‚Üì
[8] GPT-5.2 + reasoning ‚Üí Generate recommendations
  ‚Üì
[9] Pillow ‚Üí Visualization
  ‚Üì
Results (JSON + Image)
```

## üöÄ Quick Start

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd saliency-test

# –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π API –∫–ª—é—á–∏
cp config.example.py config.py
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π config.py –∏ –¥–æ–±–∞–≤—å —Å–≤–æ–π OpenAI API key
```

### 2. –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞

```bash
python analyze_creative_final.py <path_to_image>
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
python analyze_creative_final.py data/yandex_pay.png
```

### 3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

Pipeline —Å–æ–∑–¥–∞—Å—Ç 2 —Ñ–∞–π–ª–∞:
- `<name>_final.json` - JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞
- `<name>_final.jpg` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–º–∏ –∑–æ–Ω–∞–º–∏

## üåê Web UI

### –ó–∞–ø—É—Å–∫ Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```bash
streamlit run app.py
```

–û—Ç–∫—Ä–æ–π—Ç–µ URL, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç Streamlit (–æ–±—ã—á–Ω–æ http://localhost:8501).

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤ (PNG/JPG) —á–µ—Ä–µ–∑ drag-and-drop
- ‚úÖ Real-time progress tracking (30-60 —Å–µ–∫—É–Ω–¥)
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ JSON + –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ Responsive layout —Å preview –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
1. –ù–∞–∂–º–∏—Ç–µ "Browse files" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
2. –ù–∞–∂–º–∏—Ç–µ "üîç Analyze Creative"
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ (30-60 —Å–µ–∫)
4. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã

### –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
Streamlit –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —Å–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π URL –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

–î–ª—è –∑–∞–ø—É—Å–∫–∞ Web UI –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install streamlit pandas
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
saliency-test/
‚îú‚îÄ‚îÄ app.py                      # Streamlit Web UI
‚îú‚îÄ‚îÄ analyze_creative_final.py  # –û—Å–Ω–æ–≤–Ω–æ–π pipeline
‚îú‚îÄ‚îÄ config.py                   # API –∫–ª—é—á–∏ (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ config.example.py           # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ requirements.txt            # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .gitignore                  # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ data/                       # –¢–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ yandex_pay.png
‚îÇ   ‚îî‚îÄ‚îÄ yandex_market.png
‚îî‚îÄ‚îÄ examples/                   # –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    ‚îú‚îÄ‚îÄ yandex_pay_final.json
    ‚îú‚îÄ‚îÄ yandex_pay_final.jpg
    ‚îú‚îÄ‚îÄ yandex_market_final.json
    ‚îî‚îÄ‚îÄ yandex_market_final.jpg
```

## üîë API Keys

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- **OpenAI API** (GPT-4.1 –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ + GPT-5.2 –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π)

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `config.py`:
```python
OPENAI_API_KEY = "sk-proj-your-key-here"
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –§–∞–π–ª `config.py` –≤ `.gitignore` - –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –µ–≥–æ!

## üìä –§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### JSON Output

```json
{
  "image": "path/to/image.png",
  "zones": [
    {
      "type": "header",
      "label": "–†–ê–°–ö–†–£–ß–ò–í–ê–ô–¢–ï –í–´–ì–û–î–£",
      "bbox": [50, 132, 296, 166],
      "attention_pct": 47.3
    },
    {
      "type": "cta",
      "label": "–†–∞—Å–∫—Ä—É—Ç–∏—Ç–µ –≤—ã–≥–æ–¥—É!",
      "bbox": [60, 310, 260, 50],
      "attention_pct": 5.2
    }
  ],
  "total_zones_attention": 92.3,
  "background_attention": 7.7,
  "overall_score": 3.4,
  "reasoning": "–ö—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏...",
  "recommendations": [
    {
      "priority": "High",
      "title": "–£—Å–∏–ª–∏—Ç—å CTA",
      "description": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ...",
      "expected_impact": "–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç..."
    }
  ]
}
```

### –¢–∏–ø—ã –∑–æ–Ω

- `logo` - –ª–æ–≥–æ—Ç–∏–ø –±—Ä–µ–Ω–¥–∞
- `header` - –≥–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫/–æ—Ñ—Ñ–µ—Ä
- `subheader` - –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫
- `cta` - –∫–Ω–æ–ø–∫–∞ –ø—Ä–∏–∑—ã–≤–∞ –∫ –¥–µ–π—Å—Ç–≤–∏—é
- `product` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
- `description` - –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
- `legal` - —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

## üéØ –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

### Attention %

**–¶–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
- **CTA**: 15-25% (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
- **Header**: 20-35% (–Ω–æ—Ä–º–∞)
- **Product**: 20-30% (—Ö–æ—Ä–æ—à–æ)
- **Logo**: 5-10% (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
- **Background**: <20% (–∏–Ω–∞—á–µ –æ—Ç–≤–ª–µ–∫–∞–µ—Ç)

### Overall Score

- **5.0** - –æ—Ç–ª–∏—á–Ω–æ, –≤—Å–µ –∑–æ–Ω—ã –ø–æ–ª—É—á–∞—é—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ
- **4.0** - —Ö–æ—Ä–æ—à–æ, –Ω–µ–±–æ–ª—å—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- **3.0** - —Å—Ä–µ–¥–Ω–µ, –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- **2.0** - –ø–ª–æ—Ö–æ, —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- **1.0** - –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ, –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

## üî¨ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **DeepGaze IIE** - State-of-the-art saliency prediction (96-98% accuracy)
- **EasyOCR** - –¢–æ—á–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
- **GPT-4.1** - Vision –º–æ–¥–µ–ª—å –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **GPT-5.2** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å reasoning
- **OpenCV** - –£—Ç–æ—á–Ω–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∫–Ω–æ–ø–æ–∫
- **PyTorch** - ML —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è DeepGaze

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ê–Ω–∞–ª–∏–∑ –±–∞–Ω–Ω–µ—Ä–∞

```bash
python analyze_creative_final.py my_banner.jpg
```

### –ü—Ä–∏–º–µ—Ä 2: Batch –∞–Ω–∞–ª–∏–∑

```bash
for img in data/*.png; do
  python analyze_creative_final.py "$img"
done
```

### –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from analyze_creative_final import analyze_creative_final

results = analyze_creative_final('path/to/image.png', filter_legal=True)

print(f"Score: {results['overall_score']}/5.0")
for zone in results['zones']:
    print(f"{zone['type']}: {zone['attention_pct']}%")
```

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "config.py not found"
```bash
cp config.example.py config.py
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π config.py –∏ –¥–æ–±–∞–≤—å API key
```

### –û—à–∏–±–∫–∞: "ModuleNotFoundError: No module named 'easyocr'"
```bash
pip install -r requirements.txt
```

### –°–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- DeepGaze –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤–µ—Å–∞ (~500MB)
- EasyOCR –∑–∞–≥—Ä—É–∂–∞–µ—Ç —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏
- –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏ –±—É–¥—É—Ç –±—ã—Å—Ç—Ä–µ–µ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è cache)

## üìà Roadmap

- [x] Web UI (Streamlit) ‚úÖ
- [ ] API endpoint (FastAPI)
- [ ] Batch processing
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ multiple –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF report

## üìÑ License

MIT

## ü§ù Contributing

Pull requests welcome! –î–ª—è –±–æ–ª—å—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π - —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π issue.

## üìß Contact

–í–æ–ø—Ä–æ—Å—ã? –°–æ–∑–¥–∞–≤–∞–π issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
